<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./CSS/style.css" />
    <script src="./JS/funciones.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <script>
      //Aquí van las validaciones inside

      function validarStringInside(elemento, min, max) {
        if (!validarString(elemento.value, min, max)) {
          elemento.style.backgroundColor = "lightyellow";
          elemento.style.borderColor = "red";
          elemento.className = "form-control is-invalid";
        } else {
          elemento.style.backgroundColor = "";
          elemento.style.borderColor = "";
          elemento.className = "form-control is-valid";
        }
      }
      function recuperarDatos() {
        if (!document.getElementById("persona").hasAttribute("hidden")) {
          var mensCorrecto = "Nombre: " + nombre.value + ".\n";
          mensCorrecto +=
            "Apellidos : " + apellido1.value + " " + apellido2.value + ".\n";
        }else{
          var mensCorrecto = "Empresa: "+company.value+".\n"
        }
        return mensCorrecto;
      }
      function mostrarModal() {
        document.getElementById("cuerpoModal").innerText = recuperarDatos();
        var myModal = new bootstrap.Modal(document.getElementById("miModal"));
        myModal.show();
      }

      function validarForm() {
        var res = true;
        var mensaje = "";

        if (!document.getElementById("persona").hasAttribute("hidden")) {
          if (!validarString(nombre.value, 2, 50)) {
            res = false;
            mensaje +=
              "El nombre tiene que ser una cadena de caracteres de entre 2 y 50 caracteres.\n";
          }
        }

        if (!document.getElementById("persona").hasAttribute("hidden")) {
          if (!validarString(apellido1.value, 2, 50)) {
            res = false;
            mensaje += "El primero apellido es obligatorio";
          }
        }

        if (res == false) {
          alert(mensaje);
        }
        console.log("Llego hasta aqui");
        return res;
      }
    </script>
    <title>Correos</title>
  </head>
  <body>
    <div id="body">
      <div id="cabecera">
        <h1>Datos del destinatario</h1>
        <p>Introduce los datos del destinatario</p>
      </div>
      <form
        id="formulario"
        action="javascript:mostrarModal()"
        onsubmit="return validarForm()"
      >
        <div id="formBody">
          <div id="destinatarios">
            <input
              type="radio"
              checked
              name="destinatario"
              value="particular"
              id="particular"
              onclick="cambiarDestinatario(this)"
            />
            <label for="particular">Particular</label>

            <input
              type="radio"
              name="destinatario"
              value="empresa"
              id="empresa"
              onclick="cambiarDestinatario(this)"
            />
            <label for="empresa">Empresa</label>
          </div>
          <div id="persona">
            <div>
              <label for="nombre" class="col-auto"
                ><p>Nombre:(1)</p>
                <input
                  type="text"
                  id="nombre"
                  placeholder="Nombre*"
                  onfocus="entraFoco(this)"
                  onblur="saleFoco(this);validarStringInside(this,2,50)"
                />
              </label>
            </div>
            <div id="apellidos" class="row g-2">
              <div class="col-auto">
                <label for="apellido1">
                  <p>Primero apellido:</p>
                  <input
                    type="text"
                    id="apellido1"
                    placeholder="Primer apellido*"
                    onfocus="entraFoco(this)"
                    onblur="saleFoco(this);validarStringInside(this,2,50)"
                  />
                </label>
              </div>
              <div class="col-auto">
                <label for="apellido2">
                  <p>Segundo apellido:</p>
                  <input
                    type="text"
                    id="apellido2"
                    placeholder="Segundo apellido"
                  />
                </label>
              </div>
            </div>
          </div>

          <div id="companhia" hidden>
            <label for="company">
              <p>Empresa:(1)</p>
              <input
                type="text"
                id="company"
                placeholder="Compañía*"
                onfocus="entraFoco(this)"
                onblur="saleFoco(this);validarStringInside(this,2,50)"
              />
            </label>
          </div>
          <div id="identificacion" class="row g-2">
            <div class="col-auto">
              <label for="tipoId">
                <p>Tipo de documento:</p>
                <select name="" id="tipoId">
                  <option value="DNI">DNI</option>
                  <option value="NIE">NIE</option>
                  <option value="NIF">NIF</option>
                </select>
              </label>
            </div>
            <div class="col-auto">
              <label for="numId">
                <p>Número Documento:</p>
                <input type="text" id="numId" />
              </label>
            </div>
          </div>
        </div>
        <button type="submit">Enviar!!</button>
      </form>
    </div>

    <!-- Modal Datos-->
    <div
      class="modal fade"
      id="miModal"
      tabindex="-1"
      aria-labelledby="miModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="miModalLabel">Datos enviados</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body" id="cuerpoModal">
            ¡Gracias por enviar el formulario!
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cerrar
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
